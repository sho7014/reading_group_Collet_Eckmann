\documentclass[a4paper,11pt,fleqn]{article}
\usepackage[chap=2]{../ex}

\begin{document}

\maketitle
\subsection*{Errata}
\begin{itemize}
    \item p.~11, Sec.~2.3, para.~2: 

    error: $h:\Omega \to \mathbb{R}^t$

    correction: $h:\Omega \to \mathbb{R}$

    \item p.~15: 

    error: $\varrho = \sqrt{u^2+v^2}$

    correction: $\varrho = \sqrt{u^2+v^2}-1$

    \item p.~15: 

    error: $\varrho + 0.4\cos(\varphi)$

    correction: $0.25\varrho + 0.4\cos(\varphi)$

\end{itemize}
\hruleskip
\subsection{2.5.}
($\Rightarrow$) Let ${\varphi}_t, {\psi}_t$ be flows of ${\bf X}, {\bf Y}$ respectively. The definition of the flow leads to
\begin{equation}
    \dot{\varphi}_t({\bm x}) = {\bf X}({\varphi}_t({\bm x})), \quad \dot{\psi}_t({\bm x}) = {\bf Y}({\psi}_t({\bm x})).  \label{eq: flow}
\end{equation}
Suppose a diffeomorphism ${\bf \Phi}$ conjugates the flows, i.e., 
${\bf \Phi} \circ {\varphi}_t ({\bm x}) = {\psi}_t \circ {\bf \Phi}({\bm x})$. By differentiating both sides of this equation w.r.t. $t$, 
\begin{align}
    &\left[ {\mathrm D}{\bf \Phi}({\varphi}_t({\bm x})) \right]\dot{\varphi}_t({\bm x}) = \dot{\psi}_t \circ {\bf \Phi}({\bm x}) \nonumber \\
    \Leftrightarrow &\left[ {\mathrm D}{\bf \Phi}({\varphi}_t({\bm x})) \right]{\bf X}({\varphi}_t({\bm x})) = {\bf Y}({\psi}_t \circ {\bf \Phi}({\bm x}))
\end{align}
Let $t=0$, then we obtain 
\begin{equation}
    {\rm D}_x{\bf \Phi}\cdot {\bf X}({\bm x}) = {\bf Y}({\bf \Phi}({\bm x})), \label{diffeo25}
\end{equation}
since ${\varphi}_0, {\psi}_0$ are identity maps. 
\vskip 1.0em

($\Leftarrow$) Consider a diffeomorphism ${\bf \Phi}$ which satisfies Eq.~(\ref{diffeo25}). Let ${\bm y}(t) = {\bf \Phi}\circ {\varphi}_t ({\bm x})$. Then 
\begin{align}
    \dot{\bm y}(t) = D{\bf \Phi}({\varphi}_t({\bm x})){\bf X}({\varphi}_t({\bm x})) &= {\bf Y}\circ {\bf \Phi} \circ {\varphi}_t ({\bm x}) \quad (\because \ \text{eq.~}(\ref{diffeo25})) \nonumber \\
    &= {\bf Y}({\bm y}(t)). 
\end{align}
Thus ${\bm y}(t)$ is a solution of the ODE of the vector field ${\bf Y}$ and of the initial condition ${\bf \Phi}({\bm x})$. That is, ${\bm y} (t)= {\psi}_t \circ {\bf \Phi}({\bm x})$. 

\hruleskip

\subsection{2.14.}
In the $(\varrho,\varphi,w)$ coordinate system, the torus is written as 
\begin{equation}
    (\varrho,\varphi,w)^\top = (0.8\sin{\vartheta},\varphi,0.8\cos{\vartheta})^\top.
\end{equation}
Let ${\bm S}$ be the solenoid map and ${\bm p}_1 = (\varrho_1,\varphi_1,w_1)^\top, {\bm p}_2 = (\varrho_2,\varphi_2,w_2)^\top$. Suppose ${\bm S}({\bm p}_1) = {\bm S}({\bm p}_2) $. Then $\varphi_1=\varphi_2$ follows from the second component of this equation. The other components provide $\varrho_1=\varrho_2, w_1 = w_2$. Therefore the solenoid map is injective. The solenoid map operates as
\begin{equation}
    {\bm S}({\bm p})= (0.2\sin{\vartheta}+0.4\cos{\varphi},2\varphi,0.2\cos{\vartheta}+0.4\sin{\varphi})^\top. 
\end{equation}
Then we obtain 
\begin{align}
    S({\bm p})_1^2+S({\bm p})_3^2 = 0.2+0.16\sin{\vartheta}\cos{\varphi}+0.16\cos{\vartheta}\sin{\varphi} \le 0.52 < 0.64 = ({\bm p})_1^2+({\bm p})_3^2. 
\end{align}
Thus the injection is strict. 

\hruleskip

\subsection{2.16.}
Let $J_f := \{I_{f,j}\}_j = \{[a_{f,j},a_{f,j+1})\}_j$ be a set of intervals associated with a piecewise expanding map $f$ï¼Ž

\begin{lemma}\label{lem: expandingmap}\mbox{}\par 
Let $f, g$ be piecewise expanding maps. The phase space of $g\circ f$ can be decomposed into subintervals of the elements of $J_f$ such that $g\circ f$ is monotone and $C^2$ in each of the subintervals.  
\end{lemma}
\begin{proof}\mbox{}\par
Let $K$ be a minimal set which satisfies $f(I_{f,j})\subset \cup_{k\in K}I_{g,k}$. Since $f$ is monotone on $I_{f,j}$, 
\begin{equation}
    f(x) = a_{g,\min{K}+k'} \label{eq: eqnedge}
\end{equation}
have unique solution in $I_{f,j}$. Let $b_{j,k'} \ (1 \le k' \le |K|-1)$ be such solutions. 
Consider a finite sequence $a_{f,j} = b_{j,0} < b_{j,1} < \cdots < b_{j,|K|} = a_{f,j+1}$ and let $L_{j,p} := [b_{j,p},b_{j,p+1})$. 
$f, g$ are monotone $C^2$ maps on each $L_{j,p}$, so its composition $f \circ g$ is. 
\end{proof}
Suppose $f^n$ be a piecewise expanding map. The Lemma.~\ref{lem: expandingmap} tells us that the phase space of $f^{n+1}$ can be decomposed into intevals in each of which $f^{n+1}$ is monotone and $C^2$. 
Also, 
\begin{equation}
    |(f^{(n+1)m})'| \ge c^{n+1} >1
\end{equation}
holds. Therefore, $f^{n+1}$ is a piecewise expanding map. The proposition follows by induction. 
\hruleskip

\subsection{2.19.}
\begin{align}
    &f_2 \circ \Phi = 1-2\sin^2{\frac{\pi x}{2}} = \cos{\pi x} \nonumber \\
    &\Phi \circ g = \sin{\frac{\pi}{2}\left(1-2|x|\right)} = \sin\left({\frac{\pi}{2}-\pi |x|}\right) =\cos{\pi |x|} =\cos{\pi x} \nonumber \\
    &\therefore  f_2 \circ \Phi = \Phi \circ g
\end{align}

\hruleskip

\subsection{2.21.}
\begin{equation}
    \mathcal{S}^{-1}({\bf x})_j = x_{j-1}
\end{equation}

\hruleskip

\subsection{2.22.}
Let $\ \bar{} \ $ denotes a periodic part of a dyadic representation.  

If a number $x$ has a finite dyadic representation, it give rise to two representations as follows: 
\begin{align}
    x & = 0.a_1a_2a_3\cdots a_m 1 \bar{0} \nonumber \\
      & = 0.a_1a_2a_3\cdots a_m 0 \bar{1}. 
\end{align}
Thus its dyadic representation is not unique. 

Suppose that a number $x$, which admits no finite dyadic representation, have two different dyadic representation: 
\begin{align}
    x_a & = 0.a_1a_2a_3\cdots \nonumber \\
    x_b  & = 0.b_1b_2b_3\cdots  
\end{align}
Let $n$ be minumum $i$ that satisfies $a_i \neq b_i$. We can assume $a_n = 1, b_n = 0$ w.l.o.g. This means $x_a \ge x_b$ and the equality holds iff $a_{n'}=0, b_{n'} = 1 \ (n' \ge n+1)$. This contradicts our assumption that $x$ admits no finite dyadic representation. Thus such number has a unique dyadic representation. 

Therefore, the set of numbers of nonunique dyadic representation coincides with that of finite dyadic representation. The number of finite dyadic representation is rational, since it is a sum of rationals. Thus the set of numbers of nonunique dyadic representation is countable, since it is a subset of $\mathbb{Q}$. 
\hruleskip

\subsection{2.23.}

Let $x_*$ be a 32 bit (approximated) representation of $x\in [0,1)$. The inteval map act as a unilateral shift in the representation. Hence, the bits are moved to the left in order, during which the leftmost ones are discarded. When the map is applied 32 times, the least significant bit of $x_*$ is discarded at last, then bits of zeros remain. This is apparently the fixed point. 

The same applies to the case of 64 bit representation. 
\hruleskip

\subsection{2.24.}

Let $I_j := [a_j, a_{j+1}]$. 
\vskip 1.0em

(well-definedness) Since $f^n(x)$ belongs to $\Omega$ for any $n \in \mathbb{N}$, it is in one of the intervals $\{I_j \}_j$. Thus $\sigma_n$ is uniquely determined. 
That is, the code is well-defined. 
\vskip 1.0em

(invertibility) Suppose two different numbers $x_1, x_2 \in \Omega, x_1 < x_2$ share the same code, i.e., ${\bm \sigma}_1 =  {\bm \sigma}_2 \ (= {\bm \sigma})$. 

Let us show that for any $n \in \mathbb{Z}^+$, $f^n$ is monotone and $C^2$ on $[x_1, x_2]$. The base case ($n=0$) holds by definition. Suppose that $f^k$ is monotone $C^2$ map on $[x_1, x_2]$ and that $f^{k+1}$ fails to have such regularity on the interval. $f^{k+1}$ lacks such regularity only when $f^k(x_1)$ and $f^k(x_2)$ belong to different intervals $I_l, I_{l'}, l\neq l'$. This violates the assumption that ${\bm \sigma}_1 =  {\bm \sigma}_2$. Thus $f^{k+1}$ is monotone $C^2$ map on $[x_1, x_2]$. Hence the proposition follows by induction. 

Since $f$ is piecewise expanding map, there exists $m>0$ and $c>1$ such that $| (f^{m})' |>c$. Let $p \in \mathbb{N}$ satisfy $(x_2-x_1)c^p>1$. 
Using the mean value theorem and the monotonicity of $f^{mp}$, we obtain $|f^{mp}(x_2)-f^{mp}(x_1)|>1$. This contradicts the fact that $f^{mp}$ is a piecewise expanding map.

The argument above shows that the coding is injective. The coding is defined so that it is surjective. Hence the coding is invertible.  
\vskip 1.0em

(conjugacy) Let $\Phi$ be the coding map, i.e., $\Phi (x) = {\bm \sigma}$ and $\mathcal{A}:=\{0,1,2,\cdots,k-1\}$. Let us introduce 
\begin{equation}
    \Omega_s:=\left\{\mathbf{x} \in \mathcal{A}^{\mathbb{Z}^+} \mid M_{x_j, x_{j+1}}=1, \quad \forall j \in \mathbb{Z}^+\right\}, 
\end{equation}
where the transition matrix $M$ is defined as 
\begin{equation}
    M_{ij} = \left\{ \begin{array}{cc}
        1 & \text{if} \quad I_j \subset f(I_i) \\
        0 &  \text{otherwise} 
    \end{array} \right. .
\end{equation}

Let us show $\Phi([0,1))=\Omega_s$. 
\if0
Let us define a function $J$ as: 
\begin{equation}
    J(x) = I_j \ \text{if} \ x\in I_j. 
\end{equation}
\fi
If ${\bm \sigma}\in\Phi([0,1))$,  $I_{\sigma_{j+1}} \subset f(I_{\sigma_j})$ for all $j\in\mathbb{Z}^+$ due to the Markov property. Hence $\Phi([0,1))\subset \Omega_s$. Suppose there exists ${\bm \sigma}\in \Omega_s$ such that ${\bm \sigma} \notin \Phi([0,1))$. This implies that there exists a minimum $q$ such that $I_{\sigma_q} \cap f^q(I_{\sigma_0}) = \emptyset$. (to be done later)
\if0
$f(I_{\sigma_{q-1}}) \cap f^{q}(I_{\sigma_0}) \neq \emptyset$ follows from $I_{\sigma_{q-1}} \cap f^{q-1}(I_{\sigma_0}) \neq \emptyset$ and $f(A\cap B) \subseteq f(A) \cap f(B)$. This leads to $I_{\sigma_q} \cap f^q(I_{\sigma_0}) \neq \emptyset$ due to the Markov property. This contradicts the assumption and thus we obtain $\Phi([0,1))\supset \Omega_s$. 

Thus the coding provides a conjugacy between $f$ and the unilateral shift of finite type defined using $M$.  
\fi
\hruleskip

\subsection{2.26.}

\end{document}